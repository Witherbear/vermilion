<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Vermilion Playground</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.2/codemirror.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.2/theme/material.css" />
</head>
<body>
    <div id="editor"></div>
    <div id="output"></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.2/mode/clike/clike.min.js"></script>
    <script>
        var Vermilion = {
            parse: function(code) {
                var tokens = VermilionLexer.tokenize(code);
                return VermilionParser.parseExpr(tokens);
            }
        };
    </script>
    <script>
        var editor = CodeMirror(document.getElementById("editor"), {
            value: 'require("lib")\n\n' +
                'class Main:\n' +
                '    fun main():\n' +
                '        list = [1,2,3]\n\n' +
                '        print("hello world")\n\n' +
                '        if 1 == 1:\n' +
                '            "correct"\n' +
                '        elif 1 != 1:\n' +
                '            1\n' +
                '        else:\n' +
                '            0\n' +
                '        end\n' +
                '    end\n' +
                'end\n',
            mode: "text/x-c++src",
            lineNumbers: true,
            theme: "material",
            tabSize: 4,
            autofocus: true
        });

        var output = document.getElementById("output");
        editor.on("change", function() {
            output.innerHTML = '';
            try {
                var code = editor.getValue();
                var ast = Vermilion.parse(code);
                console.log(ast);
                output.innerHTML = JSON.stringify(ast, null, 2);
            } catch (err) {
                output.innerHTML = err.message;
            }
        });
    </script>
</body>
</html>
